<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="705" height="509" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[# This is a sequence diagram for the dkim section
# I used https://bramp.github.io/js-sequence-diagrams/
# to render it to svg and then save it in images folder

participant Alice as Ua
participant Alice Provider as Pa
participant Bob Provider as Pb
participant Bob as Ub


Ua -> Pa: (1) a
Pa -> Pb: (2) DKIM_ap(a)
Pb ->> Pa: (3) get ap
Pa ->> Pb: (4) ap
Note over Pb: (5) Verify_ap(DKIM_ap(a))
Pb -> Ub: (6) DKIM_ap(a)
Ub ->> Pa: (7) get ap
Pa ->> Ub: (8) ap
Note over Ub: (9) Verify_ap(DKIM_ap(a))
]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="10" y="20" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">Alice</tspan></text></g><g class="actor"><rect x="10" y="450" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="475" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">Alice</tspan></text></g><line x1="45" x2="45" y1="59" y2="450" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="100" y="20" width="160" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="110" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="110">Alice Provider</tspan></text></g><g class="actor"><rect x="100" y="450" width="160" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="110" y="475" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="110">Alice Provider</tspan></text></g><line x1="180" x2="180" y1="59" y2="450" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="280" y="20" width="140" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="290" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="290">Bob Provider</tspan></text></g><g class="actor"><rect x="280" y="450" width="140" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="290" y="475" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="290">Bob Provider</tspan></text></g><line x1="350" x2="350" y1="59" y2="450" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="485" y="20" width="50" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="495" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="495">Bob</tspan></text></g><g class="actor"><rect x="485" y="450" width="50" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="495" y="475" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="495">Bob</tspan></text></g><line x1="510" x2="510" y1="59" y2="450" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="signal"><text x="87.5" y="89.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="87.5">(1) a</tspan></text><line x1="45" x2="180" y1="98" y2="98" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="195" y="128.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="195">(2) DKIM_ap(a)</tspan></text><line x1="180" x2="350" y1="137" y2="137" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="215" y="167.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="215">(3) get ap</tspan></text><line x1="350" x2="180" y1="176" y2="176" style="stroke-width: 2; marker-end: url(&quot;#markerArrowOpen&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="235" y="206.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="235">(4) ap</tspan></text><line x1="180" x2="350" y1="215" y2="215" style="stroke-width: 2; marker-end: url(&quot;#markerArrowOpen&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="220" y="235" width="260" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="225" y="255" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="225">(5) Verify_ap(DKIM_ap(a))</tspan></text></g><g class="signal"><text x="360" y="294.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="360">(6) DKIM_ap(a)</tspan></text><line x1="350" x2="510" y1="303" y2="303" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="295" y="333.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="295">(7) get ap</tspan></text><line x1="510" x2="180" y1="342" y2="342" style="stroke-width: 2; marker-end: url(&quot;#markerArrowOpen&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="315" y="372.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="315">(8) ap</tspan></text><line x1="180" x2="510" y1="381" y2="381" style="stroke-width: 2; marker-end: url(&quot;#markerArrowOpen&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="380" y="401" width="260" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="385" y="421" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="385">(9) Verify_ap(DKIM_ap(a))</tspan></text></g></svg>