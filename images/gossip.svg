<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="685" height="1007" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[# This is a sequence diagram for the dkim section
# I used https://bramp.github.io/js-sequence-diagrams/
# to render it to svg and then save it in images folder

participant Alice as Ua
participant Attacker as At
participant Bob as Ub
participant Claire as Uc

Ua -->> At: a
At --> Ub: a'
Ub --> At: b(a')
At --> Ua: b'(a)
Ua -> Uc: a
Uc -> Ua: c(a)
Ub -> Uc: b
Uc -> Ub: c(b)
Note over Ua: a,b',c
Note over Ub: a',b,c
Note over Uc: a,b,c
Ua --> At: a(b',c)
At --> Ub: a'(b,c)
Ua -> Uc: a(b',c)
Note over Uc: C's client sees other key b' for B
Ub --> At: b(a',c)
At --> Ua: b'(a,c)
Ub -> Uc: b(a',c)
Note over Uc: C's client sees other key a' for A
Uc -> Ua: c(a,b)
Uc -> Ub: c(a,b)]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="10" y="20" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">Alice</tspan></text></g><g class="actor"><rect x="10" y="948" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">Alice</tspan></text></g><line x1="45" x2="45" y1="59" y2="948" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="100" y="20" width="100" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="110" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="110">Attacker</tspan></text></g><g class="actor"><rect x="100" y="948" width="100" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="110" y="973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="110">Attacker</tspan></text></g><line x1="150" x2="150" y1="59" y2="948" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="220" y="20" width="50" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="230" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="230">Bob</tspan></text></g><g class="actor"><rect x="220" y="948" width="50" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="230" y="973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="230">Bob</tspan></text></g><line x1="245" x2="245" y1="59" y2="948" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="390" y="20" width="80" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="400" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="400">Claire</tspan></text></g><g class="actor"><rect x="390" y="948" width="80" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="400" y="973" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="400">Claire</tspan></text></g><line x1="430" x2="430" y1="59" y2="948" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="signal"><text x="92.5" y="89.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="92.5">a</tspan></text><line x1="45" x2="150" y1="98" y2="98" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowOpen&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="187.5" y="128.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="187.5">a'</tspan></text><line x1="150" x2="245" y1="137" y2="137" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="172.5" y="167.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="172.5">b(a')</tspan></text><line x1="245" x2="150" y1="176" y2="176" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="72.5" y="206.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="72.5">b'(a)</tspan></text><line x1="150" x2="45" y1="215" y2="215" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="232.5" y="245.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="232.5">a</tspan></text><line x1="45" x2="430" y1="254" y2="254" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="217.5" y="284.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="217.5">c(a)</tspan></text><line x1="430" x2="45" y1="293" y2="293" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="332.5" y="323.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="332.5">b</tspan></text><line x1="245" x2="430" y1="332" y2="332" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="317.5" y="362.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="317.5">c(b)</tspan></text><line x1="430" x2="245" y1="371" y2="371" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="10" y="391" width="70" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="15" y="411" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="15">a,b',c</tspan></text></g><g class="note"><rect x="210" y="440" width="70" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="215" y="460" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="215">a',b,c</tspan></text></g><g class="note"><rect x="400" y="489" width="60" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="405" y="509" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="405">a,b,c</tspan></text></g><g class="signal"><text x="62.5" y="548.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="62.5">a(b',c)</tspan></text><line x1="45" x2="150" y1="557" y2="557" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="162.5" y="587.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="162.5">a'(b,c)</tspan></text><line x1="150" x2="245" y1="596" y2="596" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="202.5" y="626.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="202.5">a(b',c)</tspan></text><line x1="45" x2="430" y1="635" y2="635" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="255" y="655" width="350" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="260" y="675" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="260">C's client sees other key b' for B</tspan></text></g><g class="signal"><text x="162.5" y="714.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="162.5">b(a',c)</tspan></text><line x1="245" x2="150" y1="723" y2="723" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="62.5" y="753.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="62.5">b'(a,c)</tspan></text><line x1="150" x2="45" y1="762" y2="762" style="stroke-width: 2; stroke-dasharray: 6, 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="302.5" y="792.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="302.5">b(a',c)</tspan></text><line x1="245" x2="430" y1="801" y2="801" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="255" y="821" width="350" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="260" y="841" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="260">C's client sees other key a' for A</tspan></text></g><g class="signal"><text x="207.5" y="880.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="207.5">c(a,b)</tspan></text><line x1="430" x2="45" y1="889" y2="889" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="307.5" y="919.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="307.5">c(a,b)</tspan></text><line x1="430" x2="245" y1="928" y2="928" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>